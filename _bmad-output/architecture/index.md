# Architecture Decision Document

## Table of Contents

- [Architecture Decision Document](#table-of-contents)
  - [Project Context Analysis](./project-context-analysis.md)
    - [Requirements Overview](./project-context-analysis.md#requirements-overview)
    - [Technical Constraints & Dependencies](./project-context-analysis.md#technical-constraints-dependencies)
    - [Cross-Cutting Concerns Identified](./project-context-analysis.md#cross-cutting-concerns-identified)
    - [Multi-Perspective Analysis: Critical Architectural Gaps](./project-context-analysis.md#multi-perspective-analysis-critical-architectural-gaps)
      - [1. Story Bible Architecture - The Core Differentiator](./project-context-analysis.md#1-story-bible-architecture-the-core-differentiator)
      - [2. AI Orchestration - Multi-Provider Complexity](./project-context-analysis.md#2-ai-orchestration-multi-provider-complexity)
      - [3. Rich Text Editor Performance - 60 FPS at Scale](./project-context-analysis.md#3-rich-text-editor-performance-60-fps-at-scale)
      - [4. Professional Export Pipeline - Quality vs Complexity](./project-context-analysis.md#4-professional-export-pipeline-quality-vs-complexity)
      - [5. Data Integrity & Backup - Zero Data Loss Requirement](./project-context-analysis.md#5-data-integrity-backup-zero-data-loss-requirement)
      - [6. Prompt Library Service - AI Feature Consistency](./project-context-analysis.md#6-prompt-library-service-ai-feature-consistency)
      - [7. Telemetry & Observability - Beta Feedback Loop](./project-context-analysis.md#7-telemetry-observability-beta-feedback-loop)
      - [8. UX Services Layer - User Delight Architecture](./project-context-analysis.md#8-ux-services-layer-user-delight-architecture)
    - [Requirements Coverage Analysis](./project-context-analysis.md#requirements-coverage-analysis)
    - [Competitive Positioning & Market Reality](./project-context-analysis.md#competitive-positioning-market-reality)
    - [Persona-Driven Architectural Requirements](./project-context-analysis.md#persona-driven-architectural-requirements)
    - [Recommended Architectural Scope for Beta](./project-context-analysis.md#recommended-architectural-scope-for-beta)
    - [Quality Gates for Beta Release](./project-context-analysis.md#quality-gates-for-beta-release)
    - [Key Architectural Decisions Needed](./project-context-analysis.md#key-architectural-decisions-needed)
  - [Starter Template Evaluation](./starter-template-evaluation.md)
    - [Primary Technology Domain](./starter-template-evaluation.md#primary-technology-domain)
    - [Starter Options Considered](./starter-template-evaluation.md#starter-options-considered)
      - [Option 1: Tauri 2.0 + Svelte 5 (SELECTED)](./starter-template-evaluation.md#option-1-tauri-20-svelte-5-selected)
      - [Option 2: Electron + Vite + Svelte 5 (Not Selected)](./starter-template-evaluation.md#option-2-electron-vite-svelte-5-not-selected)
    - [Selected Starter: Tauri 2.0 + Svelte 5 + TypeScript + Rust](./starter-template-evaluation.md#selected-starter-tauri-20-svelte-5-typescript-rust)
    - [Architectural Decisions Provided by Starter](./starter-template-evaluation.md#architectural-decisions-provided-by-starter)
    - [Critical Technology Decisions (Resolved Through Team Analysis)](./starter-template-evaluation.md#critical-technology-decisions-resolved-through-team-analysis)
      - [Decision 1: Vector Store - Qdrant (Embedded Rust)](./starter-template-evaluation.md#decision-1-vector-store-qdrant-embedded-rust)
      - [Decision 2: UI Components - Custom Svelte (Fluent Design Language)](./starter-template-evaluation.md#decision-2-ui-components-custom-svelte-fluent-design-language)
      - [Decision 3: PDF Export - Puppeteer Sidecar](./starter-template-evaluation.md#decision-3-pdf-export-puppeteer-sidecar)
      - [Decision 4: DOCX Export - Node.js Sidecar (docx.js)](./starter-template-evaluation.md#decision-4-docx-export-nodejs-sidecar-docxjs)
      - [Decision 5: ML/NLP for Style Profiles - Rust-ONNX Runtime](./starter-template-evaluation.md#decision-5-mlnlp-for-style-profiles-rust-onnx-runtime)
    - [UX Services Architecture (Required for Beta)](./starter-template-evaluation.md#ux-services-architecture-required-for-beta)
      - [OnboardingService Architecture](./starter-template-evaluation.md#onboardingservice-architecture)
      - [StyleProfileService Architecture](./starter-template-evaluation.md#styleprofileservice-architecture)
      - [KeyboardShortcutService Architecture](./starter-template-evaluation.md#keyboardshortcutservice-architecture)
    - [Additional Setup Required Post-Scaffolding](./starter-template-evaluation.md#additional-setup-required-post-scaffolding)
    - [Technology Stack Summary](./starter-template-evaluation.md#technology-stack-summary)
    - [Bundle Size & Performance Analysis](./starter-template-evaluation.md#bundle-size-performance-analysis)
    - [Timeline Impact Assessment](./starter-template-evaluation.md#timeline-impact-assessment)
    - [Testing Strategy Implications](./starter-template-evaluation.md#testing-strategy-implications)
    - [Production Deployment Considerations](./starter-template-evaluation.md#production-deployment-considerations)
    - [Sources](./starter-template-evaluation.md#sources)
  - [Core Architectural Decisions](./core-architectural-decisions/index.md)
    - [Decision Priority Analysis](./core-architectural-decisions/index.md#decision-priority-analysis)
    - [Data Architecture](./core-architectural-decisions/index.md#data-architecture)
      - [Database: SQLite with rusqlite (Confirmed from Step 3)](./core-architectural-decisions/index.md#database-sqlite-with-rusqlite-confirmed-from-step-3)
      - [Migration Strategy: refinery](./core-architectural-decisions/index.md#migration-strategy-refinery)
      - [Data Validation Strategy](./core-architectural-decisions/index.md#data-validation-strategy)
      - [Caching Strategy](./core-architectural-decisions/index.md#caching-strategy)
    - [Authentication & Security](./core-architectural-decisions/index.md#authentication-security)
      - [Authentication: None Required](./core-architectural-decisions/index.md#authentication-none-required)
      - [API Key Storage: OS Keychain](./core-architectural-decisions/index.md#api-key-storage-os-keychain)
      - [Data Encryption at Rest](./core-architectural-decisions/index.md#data-encryption-at-rest)
      - [Tauri IPC Security](./core-architectural-decisions/index.md#tauri-ipc-security)
    - [AI Provider Integration Architecture](./core-architectural-decisions/index.md#ai-provider-integration-architecture)
      - [Rate Limiting Implementation: Custom Token Bucket](./core-architectural-decisions/index.md#rate-limiting-implementation-custom-token-bucket)
      - [Prompt Template Storage: Hybrid (Files → SQLite)](./core-architectural-decisions/index.md#prompt-template-storage-hybrid-files-sqlite)
    - [Frontend Architecture](./core-architectural-decisions/index.md#frontend-architecture)
      - [Styling System: Tailwind CSS](./core-architectural-decisions/index.md#styling-system-tailwind-css)
      - [Editor Library: ProseMirror](./core-architectural-decisions/index.md#editor-library-prosemirror)
      - [State Management: Svelte 5 Runes (Primary)](./core-architectural-decisions/index.md#state-management-svelte-5-runes-primary)
    - [Testing Architecture](./core-architectural-decisions/index.md#testing-architecture)
      - [Hybrid Testing Strategy](./core-architectural-decisions/index.md#hybrid-testing-strategy)
    - [Infrastructure & Deployment](./core-architectural-decisions/index.md#infrastructure-deployment)
      - [Telemetry Backend: Sentry (Beta) → Self-Hosted (Post-Launch)](./core-architectural-decisions/index.md#telemetry-backend-sentry-beta-self-hosted-post-launch)
      - [CI/CD Pipeline](./core-architectural-decisions/index.md#cicd-pipeline)
    - [Decision Impact Analysis](./core-architectural-decisions/index.md#decision-impact-analysis)
  - [Implementation Patterns & Consistency Rules](./implementation-patterns-consistency-rules/index.md)
    - [Purpose and Scope](./implementation-patterns-consistency-rules/index.md#purpose-and-scope)
    - [Naming Conventions](./implementation-patterns-consistency-rules/index.md#naming-conventions)
      - [Rust Naming (Backend) - MANDATORY](./implementation-patterns-consistency-rules/index.md#rust-naming-backend-mandatory)
      - [TypeScript Naming (Frontend) - MANDATORY](./implementation-patterns-consistency-rules/index.md#typescript-naming-frontend-mandatory)
      - [Database Naming (SQL) - MANDATORY](./implementation-patterns-consistency-rules/index.md#database-naming-sql-mandatory)
      - [Tauri Command Naming - MANDATORY](./implementation-patterns-consistency-rules/index.md#tauri-command-naming-mandatory)
      - [File Naming - MANDATORY](./implementation-patterns-consistency-rules/index.md#file-naming-mandatory)
    - [Structure Patterns](./implementation-patterns-consistency-rules/index.md#structure-patterns)
      - [Rust Module Organization - MANDATORY](./implementation-patterns-consistency-rules/index.md#rust-module-organization-mandatory)
      - [Svelte Project Organization - MANDATORY](./implementation-patterns-consistency-rules/index.md#svelte-project-organization-mandatory)
      - [Test Organization - MANDATORY](./implementation-patterns-consistency-rules/index.md#test-organization-mandatory)
      - [Tauri Commands Organization - MANDATORY](./implementation-patterns-consistency-rules/index.md#tauri-commands-organization-mandatory)
    - [Format Patterns](./implementation-patterns-consistency-rules/index.md#format-patterns)
      - [Tauri Result Types - MANDATORY](./implementation-patterns-consistency-rules/index.md#tauri-result-types-mandatory)
      - [JSON Serialization - MANDATORY](./implementation-patterns-consistency-rules/index.md#json-serialization-mandatory)
      - [Date/Time Formats - MANDATORY](./implementation-patterns-consistency-rules/index.md#datetime-formats-mandatory)
      - [Error Response Format - MANDATORY](./implementation-patterns-consistency-rules/index.md#error-response-format-mandatory)
    - [Communication Patterns](./implementation-patterns-consistency-rules/index.md#communication-patterns)
      - [Tauri Event Naming - MANDATORY](./implementation-patterns-consistency-rules/index.md#tauri-event-naming-mandatory)
      - [Event Payload Structure - MANDATORY](./implementation-patterns-consistency-rules/index.md#event-payload-structure-mandatory)
      - [State Update Patterns - MANDATORY](./implementation-patterns-consistency-rules/index.md#state-update-patterns-mandatory)
      - [Optimistic UI Pattern - MANDATORY](./implementation-patterns-consistency-rules/index.md#optimistic-ui-pattern-mandatory)
    - [Process Patterns](./implementation-patterns-consistency-rules/index.md#process-patterns)
      - [Error Handling in Rust - MANDATORY](./implementation-patterns-consistency-rules/index.md#error-handling-in-rust-mandatory)
      - [Async Usage Patterns - MANDATORY](./implementation-patterns-consistency-rules/index.md#async-usage-patterns-mandatory)
      - [Validation Layers - MANDATORY](./implementation-patterns-consistency-rules/index.md#validation-layers-mandatory)
      - [Loading State Patterns - MANDATORY](./implementation-patterns-consistency-rules/index.md#loading-state-patterns-mandatory)
    - [Enforcement Guidelines](./implementation-patterns-consistency-rules/index.md#enforcement-guidelines)
      - [All AI Agents MUST:](./implementation-patterns-consistency-rules/index.md#all-ai-agents-must)
      - [Pattern Enforcement Methods](./implementation-patterns-consistency-rules/index.md#pattern-enforcement-methods)
    - [Pattern Examples](./implementation-patterns-consistency-rules/index.md#pattern-examples)
      - [Good Example: Story Bible Entity Creation](./implementation-patterns-consistency-rules/index.md#good-example-story-bible-entity-creation)
      - [Anti-Pattern Example: What NOT to Do](./implementation-patterns-consistency-rules/index.md#anti-pattern-example-what-not-to-do)
    - [Pattern Compliance Checklist](./implementation-patterns-consistency-rules/index.md#pattern-compliance-checklist)
  - [Extended Architectural Decisions](./extended-architectural-decisions/index.md)
    - [1. Backup & Data Recovery Architecture](./extended-architectural-decisions/index.md#1-backup--data-recovery-architecture)
    - [2. AI Context Window Management](./extended-architectural-decisions/index.md#2-ai-context-window-management)
    - [3. Editor Plugin Architecture](./extended-architectural-decisions/index.md#3-editor-plugin-architecture)
    - [4. Accessibility (WCAG 2.1 AA) Architecture](./extended-architectural-decisions/index.md#4-accessibility-wcag-21-aa-architecture)
    - [5. Internationalization (i18n) Architecture](./extended-architectural-decisions/index.md#5-internationalization-i18n-architecture)
    - [6. Gamification & Motivation Service](./extended-architectural-decisions/index.md#6-gamification--motivation-service)
